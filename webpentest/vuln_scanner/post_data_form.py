
import requests
from bs4 import BeautifulSoup  # bs4 import Beautiful soup class
from urllib.parse import urljoin  # from urllib.parse module import urljoin class


def html_res(target_url):
    try:
        res = requests.get(target_url)
        return res
    except requests.exceptions.ConnectionError:
        pass


# vuln scanner
domain_url = "http://testphp.vulnweb.com"


domain_response = html_res(domain_url)  # return an object
domain_response_content = domain_response.content  # list of the return content
parser = BeautifulSoup(domain_response_content, features="lxml")  # return  lists of all content in the html page
form_tag_list = parser.findAll("form")  # return  lists of all content in the  form_list
for form in form_tag_list:
    action = form.get("action")  # this is an  attribute in the form tag, relative url to submit to
    method = form.get("method")  # this is an  attribute in the form tag, method for posting
    post_url = urljoin(domain_url, action)
    input_list = form.findAll("input")  # this extract the input list in the form list
    data_dic = {}
    for inputs in input_list:
        # input_1 = parameter, input_2 = button, care only about parameter 1
        input_name = inputs.get("name")  # this is an  attribute in the input list, parameter that hold content
        input_type = inputs.get("type")  # this is an  attribute in the input list, parameter that hold type
        input_value = inputs.get("value")   # parameter that hold value to submit form, return None and GO
        if input_type == "text":  # check that go parameter is present
            input_text = "FRANCIS_MAYOWA"
            data_dic[input_name] = input_text  # assigning or appending data to dictionary
    post_result = requests.post(domain_url, data=data_dic)  # return a object
    post_result_content = post_result.content  # see html content in bytes
    print(post_result_content)










